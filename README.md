# 東芝製PCSを改造してPV入力電圧を可変できるようにする
## 経緯
研究室同期の実験で、1kW級PVストリングの出力端電圧を変化できる昇圧チョッパが必要になったので、制作を請け負った。

## 手法
東芝製PCS「TPV-PCS0400B」の中古品をヤフオクにて3000円+送料で落札した。中身が生きていることが確認できたので、昇圧チョッパのゲート信号をArduinoから入力し、デューティー比をArduinoで制御することで、PV入力電圧を可変できるようにする。

## シリアル通信API仕様
シリアル通信で以下の文字列を送信することで、デューティー比の指定や電圧電流測定値の読み出しができる。
- 通信速度は 9600bps を設定
- コマンド
  - `getV` : 入力電圧[mV]を取得（いまは15を出しています）
  - `getI` :入力電流[mA]を取得（いまは30を出しています）
  - `getD` : 実際にPWM出力しているデューティー比[%]を取得
  - `setDxx` : デューティー比[%]を `xx` % に指定。`xx` は最小 0 ～ 最大 80 の範囲
- 返り値
  - getコマンド：数値単体が文字列で返ってくる。不正なコマンドでは`0`が返ってくる
  - setコマンド：setした数値が文字列で返ってくる。不正な値をセットしようとしたときは`0`が返ってくる